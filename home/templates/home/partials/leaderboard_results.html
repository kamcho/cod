<!-- Podium for Top 3 -->
<div class="grid grid-cols-1 md:grid-cols-3 items-end gap-6 lg:gap-10 mt-10">
    {% for player in leaderboard|slice:":3" %}
    {% if forloop.counter == 1 %}
    <!-- Rank 1 (Center on Desktop) -->
    <div class="order-1 md:order-2">
        <a href="{% url 'player_analytics' player.gamer_tag %}" class="block group">
            <div
                class="glass p-10 rounded-[2.5rem] text-center relative hover:-translate-y-2 transition-transform duration-500 border-t-4 border-t-amber-400 h-[380px] flex flex-col justify-center">
                <span
                    class="absolute -top-4 left-1/2 -translate-x-1/2 bg-amber-400 text-slate-950 px-6 py-1.5 rounded-full font-black text-xs shadow-lg shadow-amber-400/20">
                    ELITE #1
                </span>
                <div
                    class="w-28 h-28 mx-auto mb-6 rounded-full border-4 border-amber-400/30 p-1.5 group-hover:border-amber-400 transition-colors duration-500">
                    <div
                        class="w-full h-full rounded-full bg-slate-900 flex items-center justify-center overflow-hidden border-2 border-white/10">
                        {% if player.profile.avatar %}
                        <img src="{{ player.profile.avatar.url }}" class="w-full h-full object-cover">
                        {% else %}
                        <i class="fas fa-user-ninja text-3xl text-amber-400"></i>
                        {% endif %}
                    </div>
                </div>
                <h2
                    class="text-2xl font-black text-white mb-2 leading-none uppercase tracking-tighter italic group-hover:text-amber-400 transition-colors">
                    {{ player.gamer_tag }}
                </h2>
                <div class="text-3xl font-black text-primary mb-2 italic">{{ player.total_xp|default:0 }} <span
                        class="text-xs uppercase text-slate-500 tracking-widest font-bold">XP</span></div>
                <p class="text-slate-400 text-[10px] font-black uppercase tracking-[0.2em] italic">{{ player.total_kills|default:0 }} Kills Â· {{ player.matches_played }} Rounds</p>
            </div>
        </a>
    </div>
    {% elif forloop.counter == 2 %}
    <!-- Rank 2 (Left on Desktop) -->
    <div class="order-2 md:order-1">
        <a href="{% url 'player_analytics' player.gamer_tag %}" class="block group">
            <div
                class="glass p-8 rounded-[2rem] text-center relative hover:-translate-y-2 transition-transform duration-500 border-t-4 border-t-slate-400 h-[320px] flex flex-col justify-center">
                <span
                    class="absolute -top-4 left-1/2 -translate-x-1/2 bg-slate-400 text-slate-950 px-5 py-1.5 rounded-full font-black text-[10px] shadow-lg shadow-slate-400/20">
                    WARRIOR #2
                </span>
                <div
                    class="w-20 h-20 mx-auto mb-4 rounded-full border-4 border-slate-400/20 p-1 group-hover:border-slate-400 transition-colors duration-500">
                    <div
                        class="w-full h-full rounded-full bg-slate-900 flex items-center justify-center overflow-hidden border-2 border-white/10">
                        {% if player.profile.avatar %}
                        <img src="{{ player.profile.avatar.url }}" class="w-full h-full object-cover">
                        {% else %}
                        <i class="fas fa-user-ninja text-xl text-slate-400"></i>
                        {% endif %}
                    </div>
                </div>
                <h2
                    class="text-xl font-black text-white mb-1 uppercase tracking-tighter italic leading-none group-hover:text-slate-400 transition-colors">
                    {{ player.gamer_tag }}
                </h2>
                <div class="text-2xl font-black text-primary mb-1 italic">{{ player.total_xp|default:0 }} <span
                        class="text-[10px] uppercase text-slate-500 tracking-widest font-bold">XP</span></div>
                <p class="text-slate-500 text-[9px] font-black uppercase tracking-widest italic leading-none">{{ player.total_kills|default:0 }} Kills</p>
            </div>
        </a>
    </div>
    {% elif forloop.counter == 3 %}
    <!-- Rank 3 (Right on Desktop) -->
    <div class="order-3">
        <a href="{% url 'player_analytics' player.gamer_tag %}" class="block group">
            <div
                class="glass p-8 rounded-[2rem] text-center relative hover:-translate-y-2 transition-transform duration-500 border-t-4 border-t-orange-700 h-[280px] flex flex-col justify-center">
                <span
                    class="absolute -top-4 left-1/2 -translate-x-1/2 bg-orange-700 text-white px-5 py-1.5 rounded-full font-black text-[10px] shadow-lg shadow-orange-700/20">
                    STRIKER #3
                </span>
                <div
                    class="w-20 h-20 mx-auto mb-4 rounded-full border-4 border-orange-700/20 p-1 group-hover:border-orange-700 transition-colors duration-500">
                    <div
                        class="w-full h-full rounded-full bg-slate-900 flex items-center justify-center overflow-hidden border-2 border-white/10">
                        {% if player.profile.avatar %}
                        <img src="{{ player.profile.avatar.url }}" class="w-full h-full object-cover">
                        {% else %}
                        <i class="fas fa-user-ninja text-xl text-orange-700"></i>
                        {% endif %}
                    </div>
                </div>
                <h2
                    class="text-xl font-black text-white mb-1 uppercase tracking-tighter italic leading-none group-hover:text-orange-700 transition-colors">
                    {{ player.gamer_tag }}
                </h2>
                <div class="text-2xl font-black text-primary mb-1 italic">{{ player.total_xp|default:0 }} <span
                        class="text-[10px] uppercase text-slate-500 tracking-widest font-bold">XP</span></div>
                <p class="text-slate-500 text-[9px] font-black uppercase tracking-widest italic leading-none">{{ player.total_kills|default:0 }} Kills</p>
            </div>
        </a>
    </div>
    {% endif %}
    {% endfor %}
</div>

<!-- Main Leaderboard Table -->
<div class="glass rounded-[2.5rem] overflow-hidden shadow-2xl mt-16 relative">
    <div class="absolute -bottom-10 -left-10 opacity-5">
        <i class="fas fa-trophy text-[160px]"></i>
    </div>
    <div class="overflow-x-auto relative z-10">
        <table class="w-full text-left">
            <thead>
                <tr class="bg-white/5 border-b border-white/10">
                    <th class="px-8 py-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] w-24">Rank
                    </th>
                    <th class="px-8 py-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]">Operator</th>
                    <th class="px-8 py-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]">Combat Kills
                    </th>
                    <th class="px-8 py-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]">Damage Output
                    </th>
                    <th class="px-8 py-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]">Deployments
                    </th>
                    <th class="px-8 py-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] text-right">
                        Total XP</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-white/5">
                {% for player in leaderboard %}
                {% if forloop.counter > 3 %}
                <tr class="hover:bg-white/5 transition-all duration-300 group">
                    <td class="px-8 py-6">
                        <span
                            class="text-sm font-black text-slate-500 group-hover:text-primary transition-colors italic">#{{ forloop.counter }}</span>
                    </td>
                    <td class="px-8 py-6">
                        <a href="{% url 'player_analytics' player.gamer_tag %}" class="flex items-center gap-4 group/p">
                            <div
                                class="w-10 h-10 rounded-xl bg-slate-800 border-2 border-white/5 flex-shrink-0 flex items-center justify-center overflow-hidden group-hover/p:border-primary transition-all duration-300 shadow-lg">
                                {% if player.profile.avatar %}
                                <img src="{{ player.profile.avatar.url }}" class="w-full h-full object-cover">
                                {% else %}
                                <i class="fas fa-user-ninja text-xs text-slate-600"></i>
                                {% endif %}
                            </div>
                            <span
                                class="text-sm font-bold text-white group-hover/p:text-primary transition-colors uppercase tracking-tight">{{ player.gamer_tag }}</span>
                        </a>
                    </td>
                    <td
                        class="px-8 py-6 text-sm font-black text-slate-400 group-hover:text-slate-200 transition-colors uppercase tracking-widest leading-none italic">
                        {{ player.total_kills|default:0 }} <span class="text-[8px] opacity-30">KILS</span></td>
                    <td class="px-8 py-6 text-sm font-bold text-slate-500 tracking-tighter">{{ player.total_damage|default:0 }}</td>
                    <td class="px-8 py-6 text-sm font-black text-slate-500 italic uppercase tracking-widest leading-none">{{ player.matches_played }} <span class="text-[8px] opacity-30">OPs</span></td>
                    <td class="px-8 py-6 text-right">
                        <span class="text-lg font-black text-primary italic drop-shadow-[0_0_8px_rgba(56,189,248,0.2)]">{{ player.total_xp|default:0 }}</span>
                    </td>
                </tr>
                {% endif %}
                {% empty %}
                <tr>
                    <td colspan="6" class="p-24 text-center">
                        <div class="flex flex-col items-center gap-6">
                            <div
                                class="w-20 h-20 bg-slate-800/50 rounded-full flex items-center justify-center border-2 border-dashed border-white/10">
                                <i class="fas fa-radar text-3xl text-slate-700 animate-pulse"></i>
                            </div>
                            <p class="text-slate-500 font-black uppercase tracking-[0.2em] italic text-xs">Awaiting
                                strategic data for this sector...</p>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>